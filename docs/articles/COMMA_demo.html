<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Demonstration of the COMMA R Package • COMMA</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><script src="../deps/MathJax-3.2.2/tex-chtml.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Demonstration of the COMMA R Package">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">COMMA</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/COMMA_demo.html">Demonstration of the COMMA R Package</a></li>
    <li><a class="dropdown-item" href="../articles/COMMA_Notation_Guide.html">COMMA Notation Guide</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Demonstration of the COMMA R Package</h1>
                        <h4 data-toc-skip class="author">Created by
Kimberly A. Hochstedler Webb. Contact: <a href="mailto:kah343@cornell.edu" class="email">kah343@cornell.edu</a>
</h4>
            
            <h4 data-toc-skip class="date">2024-04-23</h4>
      

      <div class="d-none name"><code>COMMA_demo.Rmd</code></div>
    </div>

    
    
<p>In this vignette, we provide a demonstration of the R Package
<em>COMMA</em> (correcting misclassified mediation analysis). This
package provides methods for estimating a mediation analysis when the
binary mediator is potentially misclassified. Technical details about
estimation are not included in this demonstration. For additional
information on the methods used in this R Package, please consult
``Effect estimation in the presence of a misclassified binary mediator’’
by Kimberly A. Hochstedler Webb and Martin T. Wells.</p>
<div class="section level2">
<h2 id="model-and-conceptual-framework">Model and Conceptual Framework<a class="anchor" aria-label="anchor" href="#model-and-conceptual-framework"></a>
</h2>
<p>Let <span class="math inline">\(X\)</span> denote a predictor of
interest. <span class="math inline">\(C\)</span> denotes a matrix of
covariates. <span class="math inline">\(Y\)</span> is the outcome
variable of interest. The relationship between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> may be mediated by <span class="math inline">\(M\)</span>. <span class="math inline">\(M =
m\)</span> denotes an observation’s true mediator value, with <span class="math inline">\(m \in \{1, 2\}\)</span>. We do not observe <span class="math inline">\(M\)</span> directly. Instead, we observe <span class="math inline">\(M^*\)</span>, a potentially misclassified (noisy)
version of <span class="math inline">\(M\)</span>. Given <span class="math inline">\(M\)</span>, a subject’s observed mediator value
<span class="math inline">\(M^*\)</span> depends on a set of predictors
<span class="math inline">\(Z\)</span>. The true mediator, observed
mediator, and outcome mechanisms are provided below.</p>
<p><span class="math display">\[\text{True mediator mechanism: }
\text{logit}\{ P(M = 1 | X, \boldsymbol{C} ; \boldsymbol{\beta}) \} =
\beta_{0} + \beta_{X} X + \boldsymbol{\beta_{C} C}\]</span> <span class="math display">\[\text{Observed mediator mechanisms: }
\text{logit}\{ P(M^* = 1 | M = 1, \boldsymbol{Z} ; \boldsymbol{\gamma})
\} = \gamma_{110} + \boldsymbol{\gamma_{11Z} Z}, \\
\text{logit}\{ P(M^* = 1 | M = 2, \boldsymbol{Z} ; \boldsymbol{\gamma})
\} = \gamma_{120} + \boldsymbol{\gamma_{12Z} Z}\]</span> <span class="math display">\[\text{Outcome mechanism: } E(Y | X,
\boldsymbol{C}, M) = \theta_0 + \theta_X X + \boldsymbol{\theta_C C} +
\theta_M M + \theta_{XM} XM\]</span> If we have a Bernoulli outcome that
we model with a logit link, the <em>outcome mechanism</em> can be <span class="math inline">\(\text{logit}\{P(Y = 1 | X, \boldsymbol{C}, M) \} =
\theta_0 + \theta_X X + \boldsymbol{\theta_C C} + \theta_m M +
\theta_{XM} XM\)</span>.</p>
</div>
<div class="section level2">
<h2 id="simulate-data---normal-outcome">Simulate data - Normal outcome<a class="anchor" aria-label="anchor" href="#simulate-data---normal-outcome"></a>
</h2>
<p>We begin this demonstration by generating data using the
<code><a href="../reference/COMMA_data.html">COMMA_data()</a></code> function. The binary mediator simulated by
this scheme is subject to misclassification. The predictor related to
the true outcome mechanism is “x” and the predictor related to the
observation mechanism is “z”.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">COMMA</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">20240422</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sample_size</span> <span class="op">&lt;-</span> <span class="fl">10000</span></span>
<span></span>
<span><span class="va">n_cat</span> <span class="op">&lt;-</span> <span class="fl">2</span> <span class="co"># Number of categories in the binary mediator</span></span>
<span></span>
<span><span class="co"># Data generation settings</span></span>
<span><span class="va">x_mu</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">x_sigma</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="va">z_shape</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="va">z_scale</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="va">c_shape</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span></span>
<span><span class="co"># True parameter values (gamma terms set the misclassification rate)</span></span>
<span><span class="va">true_beta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">2</span>, <span class="fl">.5</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">true_gamma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.8</span>, <span class="fl">1</span>, <span class="op">-</span><span class="fl">1.5</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">2</span>, byrow <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> </span>
<span><span class="va">true_theta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1.5</span>, <span class="op">-</span><span class="fl">2.5</span>, <span class="op">-</span><span class="fl">.2</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Generate data.</span></span>
<span><span class="va">my_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/COMMA_data.html">COMMA_data</a></span><span class="op">(</span><span class="va">sample_size</span>, <span class="va">x_mu</span>, <span class="va">x_sigma</span>, <span class="va">z_shape</span>, <span class="va">c_shape</span>,</span>
<span>                      interaction_indicator <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                      outcome_distribution <span class="op">=</span> <span class="st">"Normal"</span>,</span>
<span>                      <span class="va">true_beta</span>, <span class="va">true_gamma</span>, <span class="va">true_theta</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Save list elements as vectors.</span></span>
<span><span class="va">Mstar</span> <span class="op">=</span> <span class="va">my_data</span><span class="op">[[</span><span class="st">"obs_mediator"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">Mstar_01</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">Mstar</span> <span class="op">==</span> <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">outcome</span> <span class="op">=</span> <span class="va">my_data</span><span class="op">[[</span><span class="st">"outcome"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">x_matrix</span> <span class="op">=</span> <span class="va">my_data</span><span class="op">[[</span><span class="st">"x"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">z_matrix</span> <span class="op">=</span> <span class="va">my_data</span><span class="op">[[</span><span class="st">"z"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">c_matrix</span> <span class="op">=</span> <span class="va">my_data</span><span class="op">[[</span><span class="st">"c"</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<div class="section level3">
<h3 id="effect-estimation">Effect estimation<a class="anchor" aria-label="anchor" href="#effect-estimation"></a>
</h3>
<p>We propose estimation methods using the Expectation-Maximization
algorithm (EM) and an ordinary least squares (OLS) correction procedure.
The proposed predictive value weighting (PVW) approach detailed in Webb
and Wells (2024) is currently only available for Bernoulli outcomes in
<em>COMMA</em>. Each method checks and corrects instances of label
switching, as described in Webb and Wells (2024). In the code below, we
provide functions for implementing these methods.</p>
<div class="section level4">
<h4 id="em-algorithm">EM algorithm<a class="anchor" aria-label="anchor" href="#em-algorithm"></a>
</h4>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Supply starting values for all parameters.</span></span>
<span><span class="va">beta_start</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">Mstar_01</span> <span class="op">~</span> <span class="va">x_matrix</span> <span class="op">+</span> <span class="va">c_matrix</span>,</span>
<span>                       family <span class="op">=</span> <span class="st">"binomial"</span><span class="op">(</span>link <span class="op">=</span> <span class="st">"logit"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">gamma_start</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">2</span>, nrow <span class="op">=</span> <span class="fl">2</span>, byrow <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">theta_start</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">outcome</span> <span class="op">~</span> <span class="va">x_matrix</span> <span class="op">+</span> <span class="va">Mstar_01</span> <span class="op">+</span> <span class="va">c_matrix</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Estimate parameters using the EM-Algorithm.</span></span>
<span><span class="va">EM_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/COMMA_EM.html">COMMA_EM</a></span><span class="op">(</span><span class="va">Mstar</span>, <span class="va">outcome</span>, outcome_distribution <span class="op">=</span> <span class="st">"Normal"</span>,</span>
<span>                       interaction_indicator <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                       <span class="va">x_matrix</span>, <span class="va">z_matrix</span>, <span class="va">c_matrix</span>,</span>
<span>                       <span class="va">beta_start</span>, <span class="va">gamma_start</span>, <span class="va">theta_start</span>, sigma_start <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">EM_results</span><span class="op">$</span><span class="va">True_Value</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">true_beta</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">true_gamma</span><span class="op">)</span>, <span class="va">true_theta</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">EM_results</span><span class="op">$</span><span class="va">Estimates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">EM_results</span><span class="op">$</span><span class="va">Estimates</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">EM_results</span></span></code></pre></div>
<pre><code><span><span class="co">##    Parameter Estimates Convergence True_Value</span></span>
<span><span class="co">## 1     beta_0     0.928        TRUE        1.0</span></span>
<span><span class="co">## 2     beta_1    -1.942        TRUE       -2.0</span></span>
<span><span class="co">## 3     beta_2     0.491        TRUE        0.5</span></span>
<span><span class="co">## 4    gamma11     1.749        TRUE        1.8</span></span>
<span><span class="co">## 5    gamma21     1.197        TRUE        1.0</span></span>
<span><span class="co">## 6    gamma12    -1.541        TRUE       -1.5</span></span>
<span><span class="co">## 7    gamma22    -0.830        TRUE       -1.0</span></span>
<span><span class="co">## 8    theta_0     1.017        TRUE        1.0</span></span>
<span><span class="co">## 9   theta_x1     1.502        TRUE        1.5</span></span>
<span><span class="co">## 10   theta_m    -2.525        TRUE       -2.5</span></span>
<span><span class="co">## 11  theta_c1    -0.199        TRUE       -0.2</span></span>
<span><span class="co">## 12     sigma     0.993        TRUE        1.0</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="ols-correction">OLS correction<a class="anchor" aria-label="anchor" href="#ols-correction"></a>
</h4>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Estimate parameters using the OLS correction.</span></span>
<span><span class="va">OLS_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/COMMA_OLS.html">COMMA_OLS</a></span><span class="op">(</span><span class="va">Mstar</span>, <span class="va">outcome</span>,</span>
<span>                         <span class="va">x_matrix</span>, <span class="va">z_matrix</span>, <span class="va">c_matrix</span>,</span>
<span>                         <span class="va">beta_start</span>, <span class="va">gamma_start</span>, <span class="va">theta_start</span><span class="op">)</span></span>
<span></span>
<span><span class="va">OLS_results</span><span class="op">$</span><span class="va">True_Value</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">true_beta</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">true_gamma</span><span class="op">)</span>, <span class="va">true_theta</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">2</span>,<span class="fl">4</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">OLS_results</span><span class="op">$</span><span class="va">Estimates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">OLS_results</span><span class="op">$</span><span class="va">Estimates</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">OLS_results</span></span></code></pre></div>
<pre><code><span><span class="co">##    Parameter Estimates Convergence Method True_Value</span></span>
<span><span class="co">## 1      beta1     0.877        TRUE    OLS        1.0</span></span>
<span><span class="co">## 2      beta2    -1.794        TRUE    OLS       -2.0</span></span>
<span><span class="co">## 3      beta3     0.493        TRUE    OLS        0.5</span></span>
<span><span class="co">## 4    gamma11     1.788        TRUE    OLS        1.8</span></span>
<span><span class="co">## 5    gamma21     1.361        TRUE    OLS        1.0</span></span>
<span><span class="co">## 6    gamma12    -1.484        TRUE    OLS       -1.5</span></span>
<span><span class="co">## 7    gamma22    -1.487        TRUE    OLS       -1.0</span></span>
<span><span class="co">## 8     theta0     0.882        TRUE    OLS        1.0</span></span>
<span><span class="co">## 9    theta_m    -2.326        TRUE    OLS       -2.5</span></span>
<span><span class="co">## 10   theta_x     1.581        TRUE    OLS        1.5</span></span>
<span><span class="co">## 11  theta_c1    -0.203        TRUE    OLS       -0.2</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="compare-results">Compare results<a class="anchor" aria-label="anchor" href="#compare-results"></a>
</h4>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">NormalY_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Parameter <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"beta_x"</span>, <span class="st">"theta_x"</span>, <span class="st">"theta_m"</span><span class="op">)</span>,</span>
<span>                                              <span class="fl">3</span><span class="op">)</span>,</span>
<span>                              Method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"EM"</span>, <span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"OLS"</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>                                         <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Naive"</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                              Estimate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">EM_results</span><span class="op">$</span><span class="va">Estimates</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">9</span>, <span class="fl">10</span><span class="op">)</span><span class="op">]</span>,</span>
<span>                                           <span class="va">OLS_results</span><span class="op">$</span><span class="va">Estimates</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">9</span>, <span class="fl">10</span><span class="op">)</span><span class="op">]</span>,</span>
<span>                                           <span class="va">beta_start</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="va">theta_start</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                              True_Value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">true_beta</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,</span>
<span>                                                 <span class="va">true_theta</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="va">true_theta</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                                               <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">NormalY_results</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Method</span>, y <span class="op">=</span> <span class="va">Estimate</span>, color <span class="op">=</span> <span class="va">Method</span><span class="op">)</span>,</span>
<span>             size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_hline</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>yintercept <span class="op">=</span> <span class="va">True_Value</span><span class="op">)</span>,</span>
<span>             linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">Parameter</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_color_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#DA86A5"</span>, <span class="st">"#785E95"</span>, <span class="st">"#409DBE"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Parameter estimates from EM, OLS, and Naive approaches"</span>,</span>
<span>          subtitle <span class="op">=</span> <span class="st">"Normal outcome model with a misclassified mediator"</span><span class="op">)</span></span></code></pre></div>
<p><img src="COMMA_demo_files/figure-html/unnamed-chunk-4-1.png" width="700" style="display: block; margin: auto;"></p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="simulate-data---bernoulli-outcome">Simulate data - Bernoulli outcome<a class="anchor" aria-label="anchor" href="#simulate-data---bernoulli-outcome"></a>
</h2>
<p>Next, we generate data with a Bernoulli outcome using the
<code><a href="../reference/COMMA_data.html">COMMA_data()</a></code> function. Once again, the binary mediator
simulated by this scheme is subject to misclassification. The predictor
related to the true outcome mechanism is “x” and the predictor related
to the observation mechanism is “z”.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">COMMA</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">20240423</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sample_size</span> <span class="op">&lt;-</span> <span class="fl">10000</span></span>
<span></span>
<span><span class="va">n_cat</span> <span class="op">&lt;-</span> <span class="fl">2</span> <span class="co"># Number of categories in the binary mediator</span></span>
<span></span>
<span><span class="co"># Data generation settings</span></span>
<span><span class="va">x_mu</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">x_sigma</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="va">z_shape</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="va">z_scale</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="va">c_shape</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span></span>
<span><span class="co"># True parameter values (gamma terms set the misclassification rate)</span></span>
<span><span class="va">true_beta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">2</span>, <span class="fl">.5</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">true_gamma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.8</span>, <span class="fl">1</span>, <span class="op">-</span><span class="fl">1.5</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">2</span>, byrow <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> </span>
<span><span class="va">true_theta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1.5</span>, <span class="op">-</span><span class="fl">2.5</span>, <span class="op">-</span><span class="fl">.2</span>, <span class="fl">.5</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Generate data.</span></span>
<span><span class="va">my_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/COMMA_data.html">COMMA_data</a></span><span class="op">(</span><span class="va">sample_size</span>, <span class="va">x_mu</span>, <span class="va">x_sigma</span>, <span class="va">z_shape</span>, <span class="va">c_shape</span>,</span>
<span>                      interaction_indicator <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                      outcome_distribution <span class="op">=</span> <span class="st">"Bernoulli"</span>,</span>
<span>                      <span class="va">true_beta</span>, <span class="va">true_gamma</span>, <span class="va">true_theta</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Save list elements as vectors.</span></span>
<span><span class="va">Mstar</span> <span class="op">=</span> <span class="va">my_data</span><span class="op">[[</span><span class="st">"obs_mediator"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">Mstar_01</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">Mstar</span> <span class="op">==</span> <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">outcome</span> <span class="op">=</span> <span class="va">my_data</span><span class="op">[[</span><span class="st">"outcome"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">x_matrix</span> <span class="op">=</span> <span class="va">my_data</span><span class="op">[[</span><span class="st">"x"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">z_matrix</span> <span class="op">=</span> <span class="va">my_data</span><span class="op">[[</span><span class="st">"z"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">c_matrix</span> <span class="op">=</span> <span class="va">my_data</span><span class="op">[[</span><span class="st">"c"</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<div class="section level3">
<h3 id="effect-estimation-1">Effect estimation<a class="anchor" aria-label="anchor" href="#effect-estimation-1"></a>
</h3>
<p>We propose estimation methods using the Expectation-Maximization
algorithm (EM) and a predictive value weighting (PVW) approach. The
ordinary least squares (OLS) correction procedure is only appropriate
for Normal outcome models. Each method checks and corrects instances of
label switching, as described in Webb and Wells (2024). In the code
below, we provide functions for implementing these methods.</p>
<div class="section level4">
<h4 id="em-algorithm-1">EM algorithm<a class="anchor" aria-label="anchor" href="#em-algorithm-1"></a>
</h4>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Supply starting values for all parameters.</span></span>
<span><span class="va">beta_start</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">Mstar_01</span> <span class="op">~</span> <span class="va">x_matrix</span> <span class="op">+</span> <span class="va">c_matrix</span>,</span>
<span>                       family <span class="op">=</span> <span class="st">"binomial"</span><span class="op">(</span>link <span class="op">=</span> <span class="st">"logit"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">gamma_start</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">2</span>, nrow <span class="op">=</span> <span class="fl">2</span>, byrow <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">xm_interaction</span> <span class="op">&lt;-</span> <span class="va">x_matrix</span> <span class="op">*</span> <span class="va">c_matrix</span></span>
<span><span class="va">theta_start</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">outcome</span> <span class="op">~</span> <span class="va">x_matrix</span> <span class="op">+</span> <span class="va">Mstar_01</span> <span class="op">+</span> <span class="va">c_matrix</span> <span class="op">+</span></span>
<span>                          <span class="va">xm_interaction</span>,</span>
<span>                        family <span class="op">=</span> <span class="st">"binomial"</span><span class="op">(</span>link <span class="op">=</span> <span class="st">"logit"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Estimate parameters using the EM-Algorithm.</span></span>
<span><span class="va">EM_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/COMMA_EM.html">COMMA_EM</a></span><span class="op">(</span><span class="va">Mstar</span>, <span class="va">outcome</span>, outcome_distribution <span class="op">=</span> <span class="st">"Bernoulli"</span>,</span>
<span>                       interaction_indicator <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                       <span class="va">x_matrix</span>, <span class="va">z_matrix</span>, <span class="va">c_matrix</span>,</span>
<span>                       <span class="va">beta_start</span>, <span class="va">gamma_start</span>, <span class="va">theta_start</span><span class="op">)</span></span>
<span></span>
<span><span class="va">EM_results</span><span class="op">$</span><span class="va">True_Value</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">true_beta</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">true_gamma</span><span class="op">)</span>, <span class="va">true_theta</span><span class="op">)</span></span>
<span><span class="va">EM_results</span><span class="op">$</span><span class="va">Estimates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">EM_results</span><span class="op">$</span><span class="va">Estimates</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">EM_results</span></span></code></pre></div>
<pre><code><span><span class="co">##    Parameter Estimates Convergence True_Value</span></span>
<span><span class="co">## 1     beta_0     1.113        TRUE        1.0</span></span>
<span><span class="co">## 2     beta_1    -2.012        TRUE       -2.0</span></span>
<span><span class="co">## 3     beta_2     0.493        TRUE        0.5</span></span>
<span><span class="co">## 4    gamma11     1.698        TRUE        1.8</span></span>
<span><span class="co">## 5    gamma21     1.036        TRUE        1.0</span></span>
<span><span class="co">## 6    gamma12    -1.664        TRUE       -1.5</span></span>
<span><span class="co">## 7    gamma22    -1.550        TRUE       -1.0</span></span>
<span><span class="co">## 8    theta_0     1.067        TRUE        1.0</span></span>
<span><span class="co">## 9    theta_x     1.565        TRUE        1.5</span></span>
<span><span class="co">## 10   theta_m    -2.538        TRUE       -2.5</span></span>
<span><span class="co">## 11  theta_c1    -0.205        TRUE       -0.2</span></span>
<span><span class="co">## 12  theta_xm     0.427        TRUE        0.5</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="pvw-approach">PVW approach<a class="anchor" aria-label="anchor" href="#pvw-approach"></a>
</h4>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">PVW_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/COMMA_PVW.html">COMMA_PVW</a></span><span class="op">(</span><span class="va">Mstar</span>, <span class="va">outcome</span>, outcome_distribution <span class="op">=</span> <span class="st">"Bernoulli"</span>,</span>
<span>                         interaction_indicator <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                         <span class="va">x_matrix</span>, <span class="va">z_matrix</span>, <span class="va">c_matrix</span>,</span>
<span>                         <span class="va">beta_start</span>, <span class="va">gamma_start</span>, <span class="va">theta_start</span><span class="op">)</span></span>
<span></span>
<span><span class="va">PVW_results</span><span class="op">$</span><span class="va">True_Value</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">true_beta</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">true_gamma</span><span class="op">)</span>, <span class="va">true_theta</span><span class="op">)</span></span>
<span><span class="va">PVW_results</span><span class="op">$</span><span class="va">Estimates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">PVW_results</span><span class="op">$</span><span class="va">Estimates</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">PVW_results</span></span></code></pre></div>
<pre><code><span><span class="co">##    Parameter Estimates Convergence Method True_Value</span></span>
<span><span class="co">## 1     beta_1     1.127        TRUE    PVW        1.0</span></span>
<span><span class="co">## 2     beta_2    -2.008        TRUE    PVW       -2.0</span></span>
<span><span class="co">## 3     beta_3     0.489        TRUE    PVW        0.5</span></span>
<span><span class="co">## 4    gamma11     1.704        TRUE    PVW        1.8</span></span>
<span><span class="co">## 5    gamma21     1.016        TRUE    PVW        1.0</span></span>
<span><span class="co">## 6    gamma12    -1.740        TRUE    PVW       -1.5</span></span>
<span><span class="co">## 7    gamma22    -1.517        TRUE    PVW       -1.0</span></span>
<span><span class="co">## 8    theta_0     0.998        TRUE    PVW        1.0</span></span>
<span><span class="co">## 9   theta_x1     1.678        TRUE    PVW        1.5</span></span>
<span><span class="co">## 10   theta_m    -2.463        TRUE    PVW       -2.5</span></span>
<span><span class="co">## 11  theta_c1    -0.204        TRUE    PVW       -0.2</span></span>
<span><span class="co">## 12  theta_xm     0.288        TRUE    PVW        0.5</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="compare-results-1">Compare results<a class="anchor" aria-label="anchor" href="#compare-results-1"></a>
</h4>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">BernoulliY_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Parameter <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"beta_x"</span>, <span class="st">"theta_x"</span>,</span>
<span>                                                   <span class="st">"theta_m"</span>, <span class="st">"theta_xm"</span><span class="op">)</span>,</span>
<span>                                                 <span class="fl">3</span><span class="op">)</span>,</span>
<span>                                 Method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"EM"</span>, <span class="fl">4</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"PVW"</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>                                            <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Naive"</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                                 Estimate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">EM_results</span><span class="op">$</span><span class="va">Estimates</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">9</span>, <span class="fl">10</span>, <span class="fl">12</span><span class="op">)</span><span class="op">]</span>,</span>
<span>                                              <span class="va">PVW_results</span><span class="op">$</span><span class="va">Estimates</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">9</span>, <span class="fl">10</span>, <span class="fl">12</span><span class="op">)</span><span class="op">]</span>,</span>
<span>                                              <span class="va">beta_start</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,</span>
<span>                                              <span class="va">theta_start</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">5</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                                 True_Value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">true_beta</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,</span>
<span>                                                    <span class="va">true_theta</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,</span>
<span>                                                    <span class="va">true_theta</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>,</span>
<span>                                                    <span class="va">true_theta</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                                                  <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">BernoulliY_results</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Method</span>, y <span class="op">=</span> <span class="va">Estimate</span>, color <span class="op">=</span> <span class="va">Method</span><span class="op">)</span>,</span>
<span>             size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_hline</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>yintercept <span class="op">=</span> <span class="va">True_Value</span><span class="op">)</span>,</span>
<span>             linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">Parameter</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_color_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#DA86A5"</span>, <span class="st">"#785E95"</span>, <span class="st">"#ECA698"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Parameter estimates from EM, PVW, and Naive approaches"</span>,</span>
<span>          subtitle <span class="op">=</span> <span class="st">"Bernoulli outcome model with a misclassified mediator"</span><span class="op">)</span></span></code></pre></div>
<p><img src="COMMA_demo_files/figure-html/unnamed-chunk-8-1.png" width="700" style="display: block; margin: auto;"></p>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Kimberly Webb.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
